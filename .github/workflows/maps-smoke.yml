name: maps-smoke
on:
  push: { branches: [ main ] }
  workflow_dispatch:
jobs:
  smoke:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
        with: { lfs: true, fetch-depth: 0 }
      - run: git lfs fetch --all && git lfs checkout
      - name: Install GDAL
        run: |
          sudo apt-get update
          sudo apt-get install -y gdal-bin
      - name: Maps smoke (toronto_downtown)
        run: make maps-smoke AREA=toronto_downtown N=20
      - name: Publish bundle (no upload)
        run: |
          make maps-publish AREA=toronto_downtown
          ls -lh artifacts/maps || true
      - name: Show readback/parity summaries
        run: |
          ls -1 maps/reports || true
          find artifacts/maps -maxdepth 1 -type f -name '*.zip*' -ls || true
