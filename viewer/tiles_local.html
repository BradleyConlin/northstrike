<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Northstrike â€” Local MBTiles Preview</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <style>
    html, body, #map { height: 100%; margin: 0; }
    .opacity { position: absolute; top: 10px; left: 10px; z-index: 1000;
      background: #fff; padding: 8px 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,.15); }
    .opacity input { width: 160px; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="opacity">
    <label>Overlay opacity <input id="op" type="range" min="0" max="1" step="0.05" value="0.7" /></label>
  </div>

  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script>
    const map = L.map('map').setView([43.6539, -79.3849], 13); // Toronto-ish

    // Base map (OSM raster)
    const osm = L.tileLayer(
      "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
      {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
      }
    ).addTo(map);

    // Local tiles from mbtileserver (leave server running on 8001)
    const gray = L.tileLayer(
      "http://127.0.0.1:8001/services/yyz_downtown_cost_gray/tiles/{z}/{x}/{y}.png",
      { maxZoom: 17, opacity: 0.7 }
    ).addTo(map);

    const color = L.tileLayer(
      "http://127.0.0.1:8001/services/yyz_downtown_cost_color/tiles/{z}/{x}/{y}.png",
      { maxZoom: 17, opacity: 0.7 }
    );

    L.control.layers(
      { "OpenStreetMap": osm },
      { "Cost (gray)": gray, "Cost (color)": color },
      { collapsed: false }
    ).addTo(map);

    // Opacity slider hooks both overlays
    const slider = document.getElementById('op');
    const setOpacity = () => { gray.setOpacity(+slider.value); color.setOpacity(+slider.value); };
    slider.addEventListener('input', setOpacity);
  </script>
</body>
</html>
